<!DOCTYPE HTML>
<!--
	Axiom by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html xmlns:th="http://www.thymeleaf.org/">
<head>
    <title>EXPO목록 - you귀농</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/expo.css" />
    <link href="http://fonts.googleapis.com/earlyaccess/jejugothic.css" rel="stylesheet">
    <style>

        h1, h2, h3, h4, a, p, li, div, input{
        }

        li>a {
            font-size: 20px;
        }
        .headermenu{
            width:1000px !important;
        }
        .twelve{
            width: 200px;
        }
        table {
            width: 112%;
        }
        li{
            margin-right: 20px !important;
        }
        #icon{
            margin-left: -100px;
            margin-bottom: -92px;
            height: 100px;
        }
        .logo{
            width: 1000px !important;
            margin-bottom: 10px;
            margin-top: 15px;
        }
        .headerlogo{
            width: 900px !important;
        }

        #subheader a{
            color: black;
        }
        .dropdown-menu{
            background: #ffff;
            color: black;
            display: flex;
            min-width: fit-content;
            max-width: 1000px;
            z-index: 10;
            position: absolute;
            top: 69px;
        }
        .dimmed{
            display: block;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            opacity: 0;
            filter: alpha(opacity=80);
            z-index: 1;
        }

        .expoItem{
            background-color: #fafcff;
            padding : 20px 0;
            border-bottom: 1px solid #3c3c3c;
            margin-top: 25px;
        }

        .expoItemInner{
            width: 970px;
            display: flex;
        }

        .itemTitle{
            overflow: hidden;
            text-overflow: ellipsis;
            max-height: 40px;
            margin-bottom: 5px;
            line-height: 20px;
            display: block;
        }

        .itemInfo{
            margin-left: 50px;
        }
        .itemDetailInner{
            font-size: 15px;
        }
        div#searchWrap{display: flex;}
        select[name='type']{width: 10%;border: solid 1px black;height: 37px;border-radius: 0%; font-weight: bold;text-align: center;font-size: 16px;color: black; }
        input[name='keyword']{
            width: 80%; margin: 0 auto; padding: 0 0; border: solid 1px black;height: 37px;border-radius: 0%;color: #000000;padding-left: 10px;}
        form[name='searchForm']{overflow: hidden;}

        .thumbImg {
            position: relative;
            display: table-cell;
            margin-top: 10px;
            vertical-align: top;
            width:200px;
            height:200px;
            margin-left:30px;>
        }

        .userId {
            display: flex;
        }
        .userId p {
            width: fit-content;
        }

    </style>
</head>
<body class="homepage is-preload">
<div id="page-wrapper">

    <th:block th:include="header.html"></th:block>

    <!--Main-->
<section>
    <div class="main" style="height: auto;">
        <div class="tle">
            <div class="category">
                <img src="/img/pageBanner_dark3.png">
            </div>
<!--            <hr style="border-top: solid 1px green; margin-top: 0px;">-->
                <a href="javascript:void(0)" class="writeButton primary button" style="float: right;margin-right: 20px;border: solid 1px green;font-weight: 100;padding:5px 12px;">EXPO 참가 등록</a></h3>
            <ul class="expoList">
                <th:block th:each="expo : ${list}">
                    <div>
                        <li class="expoItem" th:object="${expo}">
                            <div class="expoItemInner">
                                <!--썸네일 나중에-->
                                <div class="expoImgThumbnail">
                                    <ul>
                                    <img class="thumbImg" src="/img/smartFarm_sample.jpg">
                                    </ul>
                                </div>
                                <div class="itemInfo">
                                    <!--제목-->
                                    <div class="itemTitle">
                                        <h4><a target="_self" class="itemName" id="goRead" href="javascript:void(0)" name="expoTitle" th:text="*{expoTitle}"></a></h4>
                                    </div>
                                    <!--작성자-->
                                    <div class="userId">
                                        작성자 : &nbsp;<p style="color: black;margin-bottom: 10px;font-size: 13px;" name="userId" th:text="*{userId}"></p>

                                    </div>
                                    <!--내용-->
                                    <div class="itemDetail">
                                        농장 이름 : <p th:text="*{farmName}" name="farmName"></p><br>
                                        주소 : <p th:text="*{farmAddress}" name="farmAddress"></p><br>
                                        주요 품목 : <p th:text="*{farmProduct}" name="farmProduct"></p><br>
                                        전화번호 : <p th:text="*{farmPhone}" name="farmPhone"></p><br>
                                    </div>
                                    <div class="listNum">
                                        No.<p id="expoNumber" name="expoNum" th:text="*{expoNum}"></p>
                                    </div>
                                </div>
                            </div>
                        </li>
                     </div>
                </th:block>
            </ul>
            <form action="/expo/list" name="searchForm">

                <div class="fields">
                    <div class="field"></div>
                    <div style="margin-bottom: 50px; margin-top: 50px; ">
                        <div id="searchWrap" th:object="${pageMaker}" style="display: flex;">
                            <select name="keyType" th:object="${criteria}" style="padding: 0; width: 100px; font-weight: bold;">
                                <option value="">전체 ▼</option>
                                <option value="T" th:selected="*{keyType} == 'T'">제목</option>
                                <option value="C" th:selected="*{keyType} == 'C'">내용</option>
                                <option value="W" th:selected="*{keyType} == 'W'">작성자</option>
                            </select>
                            <input id="keyword" type="text" name="keyword" th:value="*{criteria.keyword}" >
                            <!--버튼-->
                            <a href="javascript:void(0)" class="search button primary icon solid fa-search" style="height: 37px;font-size: 14px;font-weight: 500;border: solid 1px green;">
                                검색
                            </a>
                        </div>
                    </div>
                </div>
            </form>
            <div th:object="${pageMaker}">
                <div class="big-width" style="text-align: center">
                    <a class="changePage" th:if="*{prev}" th:href="*{startPage - 1}"><code>&lt;</code></a>
                    <th:block th:each="num : ${#numbers.sequence(pageMaker.getStartPage(), pageMaker.getEndPage())}">
                        <code th:if="${pageMaker.criteria.getPageNum() == num}" th:text="${num}"></code>
                        <a class="changePage" th:unless="${pageMaker.criteria.getPageNum() == num}" th:href="${num}"><code th:text="${num}"></code></a>
                    </th:block>
                    <a class="changePage" th:if="*{next}" th:href="*{endPage + 1}"><code>&gt;</code></a>
                </div>
                <form action="/expo/list" th:object="${criteria}" name="pageForm">
                    <input type="hidden" name="pageNum" th:field="*{pageNum}">
                    <input type="hidden" name="amount" th:field="*{amount}">
                    <input type="hidden" name="keyType" th:field="*{keyType}">
                    <input type="hidden" name="keyword" th:field="*{keyword}">
                </form>
            </div>
        </div>
    </div>
</section>


    <th:block th:include="footer.html"></th:block>
</div>

<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.dropotron.min.js"></script>
<script src="/js/jquery.slidertron.min.js"></script>
<script src="/js/browser.min.js"></script>
<script src="/js/breakpoints.min.js"></script>
<script src="/js/util.js"></script>
<script src="/js/main.js"></script>

</body>
<script th:inline="javascript">

    let pageForm = $(document.pageForm); // 페이징 Form 태그
    let paging = [[${pageMaker.criteria.listLink}]]; // 페이징
    let searchForm = $(document.searchForm); // 검색기능 Form 태그
    let expoNum = $("#expoNumber").text(); // 엑스포 넘버

    let uploadResult = $(".expoImgThumbnail ul") // 썸네일 들어갈 태그

    $(document).ready(function(){
        (function(){
            $.getJSON("/expo/getThumbList", {expoNum : expoNum},
                function(attach){  // 썸네일 1개 가져오기
                    let str = "";
                        if (!attach.image) {   // 썸네일을 올리지 않았다면  attach.png
                            let fileCallPath = encodeURIComponent(attach.uploadPath + "/" + attach.uuid + "_" + attach.fileName);
                            str += "<li>"
                            str += "<img src='/img/attach.png' width='100px'>" + attach.fileName.substring(attach.fileName.indexOf("_") + 1);
                            str += "</li>";
                        } else { // 등록한 썸네일 넣기
                            let fileCallPath = encodeURIComponent(attach.uploadPath + "/s_" + attach.uuid + "_" + attach.fileName);
                            let originPath = encodeURIComponent(attach.uploadPath + "/" + attach.uuid + "_" + attach.fileName);

                            str += "<li>"
                            str += "<img src='/upload/display?fileName=" + fileCallPath + "'>" + attach.fileName.substring(attach.fileName.indexOf("_") + 1);
                            str += "</li>";

                        }
                    uploadResult.html(str);
                });//getJSON
        })();

    showList(pageNum);

        function goUpdate(){
            location.href = "/board/modify" + paging + "&expoNum=" + expoNum;
        }

        $("a#goList").on("click", function(){
            location.href = "/board/list" + paging;
        });


        if(expoNum == null || history.state){
            return;
        }
        alert("게시글 " + expoNum + "번이 등록되었습니다.");
        history.replaceState({}, null, null);
    });


    // 페이징 양쪽 부등호
    $("a.changePage").click(function(e){
        e.preventDefault();
        pageForm.attr("action", "/expo/list")
        pageForm.find("input[name='pageNum']").val($(this).attr("href"));
        pageForm.submit();
    });


    //제목 눌렀을 때
    $("a#goRead").on("click", function(e){
        e.preventDefault();
        console.log(expoNum);
        location.href = "/expo/readDetail" + paging  + "&expoNum=" + expoNum;
    })

    //검색할 때
    $("a.search").on("click", function(e){
        e.preventDefault();
        if(!searchForm.find("option:selected").val()){
            alert("검색 종류를 선택하세요");
            return;
        }

        if(!searchForm.find("input#keyword").val()){
            alert("키워드를 입력하세요");
            return;
        }
        searchForm.submit();
    });

    $("input#keyword").on("keydown", function(e){
        if(e.keyCode == 13){
            e.preventDefault();
        }
    })

    $("a.writeButton").on("click", function (e) {
        e.preventDefault();
        location.href = "/expo/writeExpo";
    })



</script>
</html>